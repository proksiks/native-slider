export class NativeSlider{constructor(t){if(this.slidesContainer=null,this.slides=[],this.prevButton=null,this.nextButton=null,this.pagination=null,this.paginationBullets=[],this.observer=null,this.currentIndex=0,this.options={container:t.container,slidesSelector:t.slidesSelector||".slider",slideSelector:t.slideSelector||".slide",prevButton:t.prevButton||null,nextButton:t.nextButton||null,pagination:t.pagination||null,initialSlide:t.initialSlide||0,loop:void 0===t.loop||t.loop,keyboard:void 0===t.keyboard||t.keyboard,threshold:t.threshold||.5,scrollBehavior:t.scrollBehavior||"smooth",onSlideChange:t.onSlideChange||(()=>{}),onInit:t.onInit||(()=>{})},this.container=this.getElement(this.options.container),!this.container)throw new Error("NativeSlider: Container element not found");this.init()}getElement(t){if("string"==typeof t){const e=document.querySelector(t);if(!e)throw new Error(`NativeSlider: Element not found: ${t}`);return e}return t}getElementOrNull(t){if(null===t)return null;if("string"==typeof t){const e=document.querySelector(t);if(!e)throw new Error(`NativeSlider: Element not found: ${t}`);return e}return t}init(){if(this.slidesContainer=this.container.querySelector(this.options.slidesSelector),!this.slidesContainer)throw new Error("NativeSlider: Slides container not found");if(this.slides=Array.from(this.slidesContainer.querySelectorAll(this.options.slideSelector)),0===this.slides.length)throw new Error("NativeSlider: No slides found");this.setupButtons(),this.setupPagination(),this.setupObserver(),this.options.keyboard&&this.setupKeyboard(),this.goToSlide(this.options.initialSlide,!1),this.options.onInit(this)}setupButtons(){this.options.prevButton&&(this.prevButton=this.getElementOrNull(this.options.prevButton),this.prevButton?.addEventListener("click",()=>this.prev())),this.options.nextButton&&(this.nextButton=this.getElementOrNull(this.options.nextButton),this.nextButton?.addEventListener("click",()=>this.next()))}setupPagination(){this.options.pagination&&(this.pagination=this.getElementOrNull(this.options.pagination),this.pagination&&(this.pagination.innerHTML="",this.slides.forEach((t,e)=>{const i=document.createElement("button");i.classList.add("slider-pagination-bullet"),i.setAttribute("aria-label",`Go to slide ${e+1}`),i.addEventListener("click",()=>this.goToSlide(e)),this.pagination?.appendChild(i),this.paginationBullets.push(i)}),this.updatePagination()))}updatePagination(){this.paginationBullets.forEach((t,e)=>{e===this.currentIndex?(t.classList.add("active"),t.setAttribute("aria-current","true")):(t.classList.remove("active"),t.removeAttribute("aria-current"))})}setupObserver(){const t={root:this.slidesContainer,rootMargin:"0px",threshold:this.options.threshold};this.observer=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const e=this.slides.indexOf(t.target);-1!==e&&e!==this.currentIndex&&this.setActiveSlide(e)}})},t),this.slides.forEach(t=>{this.observer?.observe(t)})}setupKeyboard(){document.addEventListener("keydown",t=>{const e=this.container.getBoundingClientRect();e.top<window.innerHeight&&e.bottom>0&&("ArrowLeft"===t.key?(t.preventDefault(),this.prev()):"ArrowRight"===t.key&&(t.preventDefault(),this.next()))})}setActiveSlide(t){t!==this.currentIndex&&(this.slides.forEach(t=>{t.classList.remove("active")}),this.slides[t]?.classList.add("active"),this.currentIndex=t,this.updatePagination(),this.options.onSlideChange(t))}goToSlide(t,e=!0){if(t<0||t>=this.slides.length)return;const i=this.slides[t];i&&(i.scrollIntoView({behavior:e?this.options.scrollBehavior:"auto",block:"nearest",inline:"center"}),this.setActiveSlide(t))}next(){const t=this.currentIndex+1;t>=this.slides.length?this.options.loop&&this.goToSlide(0):this.goToSlide(t)}prev(){const t=this.currentIndex-1;t<0?this.options.loop&&this.goToSlide(this.slides.length-1):this.goToSlide(t)}getCurrentIndex(){return this.currentIndex}getSlidesCount(){return this.slides.length}update(){this.observer?.disconnect(),this.slides=Array.from(this.slidesContainer.querySelectorAll(this.options.slideSelector)),this.pagination&&this.setupPagination(),this.setupObserver(),this.setActiveSlide(Math.min(this.currentIndex,this.slides.length-1))}destroy(){this.observer?.disconnect(),this.prevButton?.removeEventListener("click",()=>this.prev()),this.nextButton?.removeEventListener("click",()=>this.next()),this.paginationBullets=[],this.pagination&&(this.pagination.innerHTML=""),this.slides.forEach(t=>{t.classList.remove("active")})}}export default NativeSlider;